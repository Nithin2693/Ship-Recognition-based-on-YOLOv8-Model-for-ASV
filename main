# Pip install method (recommended)

!pip install ultralytics==8.0.196

from IPython import display
display.clear_output()

import ultralytics
ultralytics.checks()

from google.colab import drive
drive.mount('/content/drive')

from ultralytics import YOLO

from IPython.display import display, Image

import os
HOME = os.getcwd()

!mkdir {HOME}/datasets
%cd {HOME}/datasets

!pip install roboflow

from roboflow import Roboflow
rf = Roboflow(api_key="H89XSUsNpgyePCcS26QQ")
project = rf.workspace("ship-cj2cj").project("ship-ehmbt")
version = project.version(1)
dataset = version.download("yolov8")

!touch data1.yaml

model = YOLO('yolov8n.pt')


!yolo task=detect mode=train model=yolov8m.pt data={dataset.location}/data.yaml epochs=1 plots=True

infer= YOLO("/content/datasets/datasets/runs/detect/train/weights/best.pt")

!yolo task=detect mode=predict model=/content/datasets/datasets/datasets/runs/detect/train2/weights/best.pt conf=0.55 source= /content/drive/MyDrive


import os
import random
import cv2
import matplotlib.pyplot as plt
from IPython.display import Image

test_images_dir = "/content/datasets/datasets/datasets/runs/detect/predict6"

# Get a list of all the image files in the test images directory
image_files = os.listdir(test_images_dir)

# Choose 16 random image files from the list
random_images = random.sample(image_files, 16)

# Create a subplot with 4 rows and 4 columns
fig, axs = plt.subplots(4, 4, figsize=(15, 15))

# Iterate through the randomly selected images and display them
for i, image_file in enumerate(random_images):
    row = i // 4
    col = i % 4
    full_file_path = os.path.join(test_images_dir, image_file)
    image = cv2.imread(full_file_path)
    axs[row, col].imshow(cv2.cvtColor(image, cv2.COLOR_BGR2RGB))
    axs[row, col].axis('off')

# Show the plot

plt.show()


from IPython.display import Image

test_images = "/content/datasets/datasets/datasets/runs/detect/predict6"

# Get a list of all the image files in the training images directory
image_files = os.listdir(test_images)

# Choose 16 random image files from the list
random_images = random.sample(image_files, 16)

for image_file in random_images:
    full_file_path = os.path.join(test_images, image_file)
    image = cv2.imread(image_path)
    Image(filename=full_file_path, width=320)
    axs[row, col].imshow(cv2.cvtColor(image, cv2.COLOR_BGR2RGB))
    axs[row, col].axis('off')
    # Show the plot
    plt.show()


from IPython.display import Image
image_path = '/content/datasets/datasets/datasets/runs/detect/train2/confusion_matrix.png'

# Display the image
Image (filename=image_path, width=1200)


image_path = '/content/runs/detect/train4/results.png'

# Display the image
Image(filename=image_path, width=1200)
